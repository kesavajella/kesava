<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jella Kesava Krishna Pavan - Portfolio</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #00d2ff; 
            --accent-glow: rgba(0, 210, 255, 0.6);
            --dark-bg: #0b1e25; 
            --gradient-bg: radial-gradient(circle at center, #134e5e 0%, #0b1e25 100%);
            --text-light: #ffffff;
        }

        * { box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            margin: 0; 
            background: var(--dark-bg); 
            color: white;
            scroll-behavior: smooth; 
            overflow-x: hidden; 
            display: flex; 
            flex-direction: column; 
            min-height: 100vh; 
        }

        /* --- NAVIGATION --- */
        .header {
            background-color: rgba(11, 30, 37, 0.95);
            height: 70px;
            display: flex;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(0, 210, 255, 0.2);
        }
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 1300px;
            margin: 0 auto;
            padding: 0 20px;
        }
        .logo { color: var(--primary-color); text-decoration: none; font-weight: bold; font-size: 1.2rem; text-transform: uppercase; z-index: 1100; }
        
        .menu-toggle {
            display: none;
            font-size: 1.8rem;
            color: var(--primary-color);
            cursor: pointer;
            z-index: 1100;
        }

        .nav-wrapper { display: flex; align-items: center; gap: 10px; }
        .nav { display: flex; list-style: none; gap: 5px; margin: 0; padding: 0; align-items: center; }
        .nav a { color: white; text-decoration: none; padding: 8px 12px; font-size: 0.95rem; transition: 0.3s; cursor: pointer; }
        .nav a:hover { color: var(--primary-color); }
        
        #admin-link {
            border: 2px solid var(--primary-color);
            border-radius: 5px;
            display: none; 
        }

        .header-icon { 
            width: 40px; 
            height: 40px; 
            border-radius: 50%; 
            border: 2px solid var(--primary-color); 
            object-fit: cover; 
            margin-left: 10px;
        }

        /* --- MOBILE NAVIGATION --- */
        @media (max-width: 768px) { 
            .menu-toggle { display: block; }
            
            .nav-wrapper {
                position: absolute;
                top: 75px;
                right: 20px;
                width: 220px;
                background: var(--dark-bg); 
                flex-direction: column;
                padding: 25px 15px;
                border-radius: 15px;
                border: 1px solid var(--primary-color);
                box-shadow: 0 10px 30px rgba(0, 210, 255, 0.3);
                display: none; 
                opacity: 0;
                transform: translateY(-10px);
                transition: 0.3s ease;
                z-index: 1050;
            }
            
            .nav-wrapper.active {
                display: flex;
                opacity: 1;
                transform: translateY(0);
            }

            .nav { flex-direction: column; width: 100%; gap: 12px; }
            .nav a { font-size: 1.1rem; width: 100%; text-align: center; }
            
            .header-icon { 
                order: 10; 
                margin: 15px auto 0;
                width: 55px;
                height: 55px;
                border: 2px solid var(--primary-color);
            }

            .nav::after {
                content: "";
                width: 70%;
                height: 1px;
                background: rgba(0, 210, 255, 0.3);
                margin: 10px auto;
                order: 9;
            }
        }

        /* --- RESPONSIVE GLOW SYSTEM --- */
        @keyframes pulseGlow {
            0% { box-shadow: 0 0 5px rgba(0, 210, 255, 0.2); border-color: rgba(0, 210, 255, 0.3); }
            50% { box-shadow: 0 0 20px rgba(0, 210, 255, 0.5); border-color: rgba(0, 210, 255, 0.6); }
            100% { box-shadow: 0 0 5px rgba(0, 210, 255, 0.2); border-color: rgba(0, 210, 255, 0.3); }
        }

        .view-work-btn, .filter-btn, .action-btn {
            transition: all 0.3s ease-in-out;
            -webkit-tap-highlight-color: transparent;
        }

        .stat-block { 
            background: rgba(255, 255, 255, 0.05); 
            border: 1px solid rgba(0, 210, 255, 0.3); 
            border-radius: 15px; 
            padding: 25px; 
            text-align: center; 
            animation: pulseGlow 3s infinite ease-in-out;
            transition: 0.3s ease;
            outline: none;
            width: 100%;
        }

        .stat-block:hover, .stat-block:active, .stat-block:focus {
            animation: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 30px var(--primary-color);
            transform: translateY(-5px);
            background: rgba(0, 210, 255, 0.1);
        }

        .view-work-btn:hover, .view-work-btn:active {
            box-shadow: 0 0 25px var(--primary-color);
            transform: scale(1.05);
        }

        /* --- SECTIONS --- */
        .glowing-section {
            margin: 40px 20px;
            padding: 60px 40px;
            border: 2px solid var(--primary-color);
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.02);
            box-shadow: 0 0 10px rgba(0, 210, 255, 0.4), 0 0 20px rgba(0, 210, 255, 0.2);
            position: relative;
            backdrop-filter: blur(5px);
            overflow: hidden; 
        }

        #home-section { min-height: 85vh; background: var(--gradient-bg); display: flex; align-items: center; }
        .hero-container { display: flex; align-items: center; justify-content: space-between; width: 100%; max-width: 1200px; margin: 0 auto; z-index: 2; position: relative; }
        .dot { position: absolute; width: 3px; height: 3px; background: white; border-radius: 50%; opacity: 0.6; box-shadow: 0 0 8px white; z-index: 1; animation: moveDots 10s linear infinite; }
        @keyframes moveDots { 0% { transform: translateY(100vh) translateX(0); opacity: 0; } 20% { opacity: 0.8; } 100% { transform: translateY(-10vh) translateX(50px); opacity: 0; } }
        .hero-text { flex: 1; text-align: left; }
        .typing-container { font-size: clamp(2rem, 5vw, 3.5rem); font-weight: 800; color: var(--primary-color); }
        .view-work-btn { display: inline-block; margin-top: 30px; padding: 12px 35px; background: linear-gradient(45deg, #00d2ff, #3a7bd5); color: white; text-decoration: none; border-radius: 50px; font-weight: bold; border: none; cursor: pointer; }
        .profile-photo { width: clamp(250px, 30vw, 350px); height: clamp(250px, 30vw, 350px); border-radius: 50%; border: 5px solid var(--primary-color); object-fit: cover; margin-left: 20px; }

        .stats-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; max-width: 1200px; margin: 0 auto 40px; }
        .stat-block i { font-size: 1.5rem; color: var(--primary-color); margin-bottom: 10px; display: block; }
        .stat-block h3 { font-size: 2rem; margin: 5px 0; }

        /* --- FILTERS --- */
        .filter-section { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: flex-start; max-width: 1200px; margin: 0 auto 30px; gap: 20px; }
        .search-box { flex: 1; min-width: 300px; }
        .search-box input { width: 100%; padding: 15px 20px; border-radius: 30px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(0, 210, 255, 0.3); color: white; outline: none; }
        .skill-filters { flex: 1; min-width: 300px; display: flex; flex-wrap: wrap; gap: 8px; justify-content: flex-end; }
        .filter-btn { padding: 8px 15px; border-radius: 20px; border: 1px solid rgba(0, 210, 255, 0.4); background: transparent; color: #fff; cursor: pointer; transition: 0.3s; }
        .filter-btn.active { background: var(--primary-color); color: #000; }

        /* --- PROJECTS --- */
        #projects-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 30px; max-width: 1200px; margin: 0 auto; }
        .project-card { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 15px; overflow: hidden; cursor: pointer; transition: 0.3s; }
        .project-card:hover { transform: translateY(-10px); border-color: var(--primary-color); }
        .tech-tag { background: rgba(0, 210, 255, 0.15); color: var(--primary-color); padding: 4px 10px; border-radius: 5px; font-size: 0.8rem; }

        /* --- MODAL --- */
        .modal {
            display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; 
            background-color: rgba(0,0,0,0.9); backdrop-filter: blur(8px); align-items: center; justify-content: center; padding: 20px;
        }
        .modal-content { background: #0b1e25; border: 1px solid var(--primary-color); border-radius: 15px; max-width: 1000px; width: 100%; max-height: 90vh; overflow-y: auto; position: relative; box-shadow: 0 0 30px var(--accent-glow); }
        .modal-header { background: linear-gradient(90deg, #00d2ff, #9d50bb); padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; }
        .modal-body { padding: 25px; display: flex; flex-wrap: wrap; gap: 20px; }
        .modal-left { flex: 1.5; min-width: 300px; }
        .modal-right { flex: 1; min-width: 250px; }
        .close-modal { font-size: 2rem; color: white; cursor: pointer; line-height: 1; }
        .btn-group { display: flex; gap: 15px; margin-top: 20px; flex-direction: column; }
        .action-btn-row { display: flex; gap: 15px; }
        .action-btn { padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: bold; display: flex; align-items: center; gap: 8px; flex: 1; justify-content: center; }
        .demo-btn { background: #00d2ff; color: #000; }
        .git-btn { background: #333; color: #fff; border: 1px solid #555; }
        .link-msg { font-size: 0.85rem; color: #ffca28; margin-top: 5px; display: block; font-style: italic; }

        /* Education Specific Styling */
        .edu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 30px;
            justify-content: center;
        }
        .edu-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 210, 255, 0.2);
            padding: 20px;
            border-radius: 15px;
            transition: 0.3s;
        }
        .edu-year { color: var(--primary-color); font-weight: bold; }
        
        /* Unified Footer */
        .unified-footer {
            background: rgba(11, 30, 37, 0.98);
            border-top: 1px solid rgba(0, 210, 255, 0.2);
            padding: 40px 20px 20px;
            margin-top: auto;
        }
        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 30px;
        }
        .social-links a {
            color: white;
            font-size: 1.5rem;
            margin-right: 15px;
            transition: 0.3s;
        }
        .social-links a:hover { color: var(--primary-color); }
        .copyright-area {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            color: #888;
        }
    </style>
</head>
<body>

<header class="header">
    <div class="header-content">
        <a onclick="navigateToHome()" class="logo" style="cursor: pointer;">Jella Kesava Krishna Pavan</a>
        <div class="menu-toggle" id="menuToggle"><i class="fas fa-bars"></i></div>
        <div class="nav-wrapper" id="navWrapper">
            <nav id="navbar">
                <ul class="nav">
                    <li><a onclick="navigateToHome()">Home</a></li>
                    <li><a onclick="scrollToSection('about-me')">About</a></li>
                    <li><a onclick="scrollToSection('education')">Education</a></li>
                    <li><a onclick="scrollToSection('skills')">Skills</a></li>
                    <li><a href="#projects" onclick="closeMobileMenu()">Projects</a></li>
                    <li><a href="#certificates" onclick="closeMobileMenu()">Certificates</a></li>
                    <li><a href="#contact" onclick="closeMobileMenu()">Contact</a></li>
                    <li><a href="admin.html" id="admin-link">Admin</a></li>
                </ul>
            </nav>
            <img src="" alt="" class="header-icon profile-img-sync">
        </div>
    </div>
</header>

<main>
    <div id="view-home" class="page-view">
        <section class="glowing-section" id="home-section">
            <div class="hero-container">
                <div class="hero-text">
                    <p style="font-size: 1.5rem; margin:0; opacity: 0.8;">Hi, I'm</p>
                    <div class="typing-container"><span id="typewriter"></span><span style="animation:blink 1s infinite">|</span></div>
                    <p style="font-size: 1.4rem; color: #ccc;">Java Full Stack Developer & Data Analyst</p>
                    <button class="view-work-btn" onclick="window.location.hash='projects'">View My Work</button>
                </div>
                <img src="" id="hero-photo" class="profile-photo">
            </div>
        </section>

        <section id="about-me" class="glowing-section">
            <h2 style="color:var(--primary-color);">About Me</h2>
            <p id="about-text" style="font-size: 1.2rem; line-height: 1.8; color: #ccc;">Currently pursuing my B.Tech at Aditya Engineering College, I have cultivated a robust foundation in engineering principles and a specialized focus on modern software development. My academic journey is defined by a relentless drive to bridge the gap between complex theoretical concepts and high-impact, real-world applications. As a Java Full Stack Developer and Data Analyst, I specialize in building scalable, secure, and user-centric digital solutions, leveraging the power of the Java ecosystem alongside modern frontend technologies to deliver seamless end-to-end experiences. Beyond core development, I am deeply passionate about the intersection of data and decision-making. My expertise in Data Analytics allows me to extract meaningful insights from complex datasets, transforming raw information into strategic advantages.</p>
        </section>

        <section id="education" class="glowing-section">
            <h2 style="color:var(--primary-color);">Education</h2>
            <div class="edu-grid">
                <div class="edu-card" tabindex="0">
                    <span class="edu-year">2023 — Present</span>
                    <h3 class="edu-degree">Bachelor of Technology (B.Tech)</h3>
                    <p class="edu-inst">Aditya Engineering College</p>
                    <span class="edu-score">CGPA: 9.02/10.0</span>
                    <p style="font-size:0.9rem; color:rgba(255,255,255,0.7); margin-top:10px;">Focusing on Information Technology. Developing advanced skills in Software Development Life Cycle (SDLC) and Data Engineering.</p>
                </div>
                <div class="edu-card" tabindex="0">
                    <span class="edu-year">2021 — 2023</span>
                    <h3 class="edu-degree">Intermediate (MPC)</h3>
                    <p class="edu-inst">Naryana Junior College</p>
                    <span class="edu-score">Percentage: 94.3%</span>
                    <p style="font-size:0.9rem; color:rgba(255,255,255,0.7); margin-top:10px;">Excelled in Mathematics and Physics, providing a logical base for my career in programming and analytics.</p>
                </div>
                <div class="edu-card" tabindex="0">
                    <span class="edu-year">2020 — 2021</span>
                    <h3 class="edu-degree">Secondary School Certificate (10th)</h3>
                    <p class="edu-inst">Narayana E.M high School</p>
                    <span class="edu-score">Percentage: 100%</span>
                    <p style="font-size:0.9rem; color:rgba(255,255,255,0.7); margin-top:10px;">Achieved perfect Percentage, demonstrating consistent academic dedication.</p>
                </div>
            </div>
        </section>

        <section id="skills" class="glowing-section">
            <h2 style="color:var(--primary-color);">Technical Skills</h2>
            <div id="skills-grid" style="display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:20px; justify-content: center;"></div>
        </section>
    </div>

    <div id="view-projects" class="page-view" style="display:none; padding: 40px 20px;">
        <div style="text-align:center; margin-bottom: 50px;">
            <h2 style="font-size: 3rem; color: var(--primary-color); margin: 0;">My Projects</h2>
            <p style="color: #ccc;">A showcase of my best work and technology stack</p>
        </div>
        
        <div class="stats-container">
            <div class="stat-block" tabindex="0"><i class="fas fa-project-diagram"></i><h3 id="stat-total">0</h3><p>Projects</p></div>
            <div class="stat-block" tabindex="0"><i class="fas fa-code"></i><h3 id="stat-tech">0</h3><p>Technologies</p></div>
            <div class="stat-block" tabindex="0"><i class="fas fa-calendar-check"></i><h3 id="stat-active">0</h3><p>Active</p></div>
            <div class="stat-block" tabindex="0"><i class="fas fa-star"></i><h3 id="stat-featured">0</h3><p>Featured</p></div>
        </div>

        <div class="filter-section">
            <div class="search-box">
                <input type="text" id="projectSearch" placeholder="Search projects..." oninput="filterProjects()">
            </div>
            <div class="skill-filters" id="skillFilters">
                <button class="filter-btn active" onclick="setFilter('All')">All</button>
            </div>
        </div>

        <div id="projects-grid"></div>
    </div>

    <div id="view-certificates" class="page-view" style="display:none; padding: 40px 20px;">
        <div style="text-align:center; margin-bottom: 50px;">
            <h2 style="font-size: 3rem; color: var(--primary-color); margin: 0;">Certifications</h2>
            <p style="color: #ccc;">Official recognition of my technical expertise</p>
        </div>

        <div class="stats-container" id="certs-stats-container">
            <div class="stat-block" tabindex="0"><i class="fas fa-award"></i><h3 id="cert-stat-total">0</h3><p>Certificates</p></div>
            <div class="stat-block" tabindex="0"><i class="fas fa-university"></i><h3 id="cert-stat-orgs">0</h3><p>Organizations</p></div>
            <div class="stat-block" tabindex="0"><i class="fas fa-check-circle"></i><h3 id="cert-stat-verified">0</h3><p>Verified</p></div>
            <div class="stat-block" tabindex="0"><i class="fas fa-calendar-alt"></i><h3 id="cert-stat-year">2025</h3><p>Current Year</p></div>
        </div>

        <div id="certs-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 30px; max-width: 1200px; margin: 0 auto;">
            </div>
    </div>

    <div id="projectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle" style="margin:0;">Project Title</h2>
                <span class="close-modal" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="modal-left" id="modalVideoContainer"></div>
                <div class="modal-right">
                    <p id="modalDesc" style="line-height:1.6; color:#ccc;"></p>
                    <h4 style="color:var(--primary-color);"><i class="fas fa-tools"></i> Technologies Used:</h4>
                    <div id="modalTechGrid" style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:20px;"></div>
                    <div class="btn-group">
                        <div class="action-btn-row">
                            <a href="#" id="liveDemoLink" class="action-btn demo-btn" target="_blank"><i class="fas fa-external-link-alt"></i> Live Demo</a>
                            <a href="#" id="githubLink" class="action-btn git-btn" target="_blank"><i class="fab fa-github"></i> GitHub</a>
                        </div>
                        <div id="linkStatusMsg"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="certModal" class="modal" onclick="this.style.display='none'">
        <span class="close-modal" style="position:absolute; top:20px; right:30px;">&times;</span>
        <img id="fullCertImage" style="max-width:90%; max-height:90%; border:3px solid var(--primary-color); box-shadow: 0 0 50px rgba(0,210,255,0.5); border-radius: 8px; object-fit: contain;">
    </div>

    <div id="view-contact" class="page-view" style="display:none;">
        <div class="glowing-section contact-container" style="max-width: 600px; margin: 40px auto; text-align: center;">
            <h2 style="color:var(--primary-color);">Get In Touch</h2>
            <form class="contact-form">
                <input type="text" placeholder="Name" style="width:100%; padding:15px; margin:10px 0; background:rgba(255,255,255,0.05); border:1px solid #333; color:white;" required>
                <input type="email" placeholder="Email" style="width:100%; padding:15px; margin:10px 0; background:rgba(255,255,255,0.05); border:1px solid #333; color:white;" required>
                <textarea rows="6" placeholder="Message" style="width:100%; padding:15px; margin:10px 0; background:rgba(255,255,255,0.05); border:1px solid #333; color:white;" required></textarea>
                <button type="submit" class="view-work-btn" style="width:100%;">Send</button>
            </form>
        </div>
    </div>
</main>

<footer class="unified-footer">
    <div class="footer-container">
        <div class="footer-left">
            <h3 style="color:var(--primary-color); margin-bottom:10px;">Connect With Me</h3>
            <div class="social-links">
                <a href="https://www.linkedin.com/in/kesava-jella" target="_blank"><i class="fab fa-linkedin"></i></a>
                <a href="https://wwww.github.com/kesavajella" target="_blank"><i class="fab fa-github"></i></a>
                <a href="https://leetcode.com/u/Kesava78615/" target="_blank"><i class="fas fa-code"></i></a>
                <a href="https://www.geeksforgeeks.org/user/kesava78615/" target="_blank"><i class="fas fa-terminal"></i></a>
                <a href="https://www.codechef.com/users/kesava78615" target="_blank"><i class="fas fa-laptop-code"></i></a>
            </div>
        </div>
        <div class="footer-right">
            <strong>Jella Kesava Krishna Pavan</strong>
            <p><i class="fas fa-envelope" style="margin-right:8px;"></i> kesavajella2006@gmail.com</p>
            <p><i class="fas fa-phone" style="margin-right:8px;"></i> +91 9949900254</p>
        </div>
    </div>
    <div class="copyright-area"> &copy; 2025 Jella Kesava Krishna Pavan. All Rights Reserved. </div>
</footer>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
    import { getFirestore, doc, collection, getDoc, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCFMubpD-kADaPCfpRNZltcvcUOF8FxM2Q",
        authDomain: "portfolio-k78615.firebaseapp.com",
        projectId: "portfolio-k78615",
        storageBucket: "portfolio-k78615.appspot.com",
        messagingSenderId: "964001708850",
        appId: "1:964001708850:web:fe381d8843621139aab52b"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    let projectCache = [];
    let activeFilter = 'All';
    const fullName = "Jella Kesava Krishna Pavan";
    let charIdx = 0;

    const menuToggle = document.getElementById('menuToggle');
    const navWrapper = document.getElementById('navWrapper');

    menuToggle.addEventListener('click', (e) => {
        e.stopPropagation();
        navWrapper.classList.toggle('active');
        menuToggle.innerHTML = navWrapper.classList.contains('active') ? '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
    });

    document.addEventListener('click', (e) => {
        if (!navWrapper.contains(e.target) && e.target !== menuToggle) {
            closeMobileMenu();
        }
    });

    window.closeMobileMenu = () => {
        navWrapper.classList.remove('active');
        menuToggle.innerHTML = '<i class="fas fa-bars"></i>';
    };

    async function loadData() {
        const configSnap = await getDoc(doc(db, "admin_config", "config"));
        if (configSnap.exists()) {
            const url = configSnap.data().profilePhoto;
            document.querySelectorAll('.profile-img-sync').forEach(img => img.src = url);
            document.getElementById('hero-photo').src = url;
        }
        
        const dataSnap = await getDoc(doc(db, "admin_data", "data"));
        if (dataSnap.exists()) {
            const skills_ordered = dataSnap.data().skills_ordered || [];
            const skillsGrid = document.getElementById('skills-grid');
            skillsGrid.innerHTML = ''; 

            skills_ordered.sort((a, b) => (a.position || 0) - (b.position || 0)).forEach((skillObj) => {
                const category = skillObj.category;
                const skillsString = skillObj.skills;
                if(!skillsString || !category) return; 

                const categoryBlock = document.createElement('div');
                categoryBlock.className = 'stat-block'; 
                categoryBlock.style.textAlign = 'left';
                categoryBlock.style.padding = '20px';
                
                const skillList = skillsString.split(',').map(s => s.trim()).filter(s => s !== "");
                let iconClass = 'fa-code'; 
                const lowerCat = category.toLowerCase();
                if(lowerCat.includes('front')) iconClass = 'fa-laptop-code';
                else if(lowerCat.includes('back')) iconClass = 'fa-server';
                else if(lowerCat.includes('data')) iconClass = 'fa-database';
                else if(lowerCat.includes('tool')) iconClass = 'fa-tools';
                else if(lowerCat.includes('lang')) iconClass = 'fa-terminal';

                categoryBlock.innerHTML = `
                    <div style="display:flex; align-items:center; gap:10px; margin-bottom:15px; border-bottom:1px solid rgba(0,210,255,0.2); padding-bottom:10px;">
                        <i class="fas ${iconClass}" style="font-size:1.2rem; margin-bottom:0; color:var(--primary-color);"></i>
                        <h3 style="font-size:1.1rem; margin:0; color:var(--primary-color); text-transform:uppercase; letter-spacing:1px;">${category}</h3>
                    </div>
                    <div style="display:flex; flex-wrap:wrap; gap:8px;">
                        ${skillList.map(skill => `<span class="tech-tag" style="background:rgba(255,255,255,0.08); color:white; border:1px solid rgba(0,210,255,0.2);">${skill}</span>`).join('')}
                    </div>
                `;
                skillsGrid.appendChild(categoryBlock);
            });
        }

        const q = query(collection(db, "projects"), orderBy("position", "asc"));
        const projSnap = await getDocs(q);
        const uniqueTechs = new Set();
        projectCache = [];
        projSnap.forEach(snap => {
            const p = { id: snap.id, ...snap.data() };
            projectCache.push(p);
            (p.technologies || []).forEach(t => uniqueTechs.add(t));
        });

        document.getElementById('stat-total').textContent = projectCache.length;
        document.getElementById('stat-tech').textContent = uniqueTechs.size;
        document.getElementById('stat-active').textContent = projectCache.length;
        document.getElementById('stat-featured').textContent = projectCache.length;

        const filterContainer = document.getElementById('skillFilters');
        Array.from(uniqueTechs).sort().forEach(tech => {
            const btn = document.createElement('button');
            btn.className = 'filter-btn';
            btn.textContent = tech;
            btn.onclick = () => setFilter(tech);
            filterContainer.appendChild(btn);
        });
        renderProjects();
    }

    // UPDATED FUNCTION TO LOAD CERTIFICATES WITH STATS
    async function loadCertificates() {
        const grid = document.getElementById('certs-grid');
        grid.innerHTML = '<p style="color:#888;">Loading certifications...</p>';
        
        try {
            const q = query(collection(db, "certificates"), orderBy("position", "asc"));
            const snap = await getDocs(q);
            grid.innerHTML = '';
            
            if (snap.empty) {
                grid.innerHTML = '<p style="color:#888;">No certificates added yet.</p>';
                document.getElementById('cert-stat-total').textContent = "0";
                document.getElementById('cert-stat-orgs').textContent = "0";
                document.getElementById('cert-stat-verified').textContent = "0";
                return;
            }

            const uniqueOrgs = new Set();
            let totalCerts = 0;

            snap.forEach(docSnap => {
                const c = docSnap.data();
                totalCerts++;
                if(c.org) uniqueOrgs.add(c.org);

                const card = document.createElement('div');
                card.className = 'project-card';
                card.innerHTML = `
                    <div style="height:200px; background:#000; overflow:hidden;">
                        <img src="${c.image}" style="width:100%;height:100%;object-fit:cover; opacity:0.8; transition: 0.5s;">
                    </div>
                    <div style="padding:15px; text-align:center;">
                        <h3 style="color:var(--primary-color); font-size:1.1rem; margin:0;">${c.title}</h3>
                        <p style="color:#aaa; font-size:0.9rem; margin:5px 0;">${c.org || ''}</p>
                        <button class="view-work-btn" style="padding:5px 15px; font-size:0.8rem; margin-top:10px;">View Full Screen</button>
                    </div>
                `;
                card.onclick = () => {
                    document.getElementById('fullCertImage').src = c.image;
                    document.getElementById('certModal').style.display = 'flex';
                };
                grid.appendChild(card);
            });

            // Update stats
            document.getElementById('cert-stat-total').textContent = totalCerts;
            document.getElementById('cert-stat-orgs').textContent = uniqueOrgs.size;
            document.getElementById('cert-stat-verified').textContent = totalCerts;

        } catch (err) {
            grid.innerHTML = '<p style="color:red;">Error loading certificates.</p>';
        }
    }

    window.setFilter = (tech) => {
        activeFilter = tech;
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.toggle('active', b.textContent === tech));
        filterProjects();
    };

    window.filterProjects = () => {
        const searchTerm = document.getElementById('projectSearch').value.toLowerCase();
        const filtered = projectCache.filter(p => {
            const matchName = p.title.toLowerCase().includes(searchTerm);
            const matchTech = activeFilter === 'All' || (p.technologies && p.technologies.includes(activeFilter));
            return matchName && matchTech;
        });
        renderProjects(filtered);
    };

    function renderProjects(data = projectCache) {
        const grid = document.getElementById('projects-grid');
        grid.innerHTML = data.map(p => `
            <div class="project-card" onclick="openProject('${p.id}')">
                <div style="height:220px; background:#000;"><img src="${p.image || ''}" style="width:100%;height:100%;object-fit:cover;"></div>
                <div style="padding:20px;">
                    <h3 style="color:var(--primary-color);margin:0;">${p.title}</h3>
                    <div style="margin-top:15px; display:flex; gap:8px; flex-wrap:wrap;">
                        ${(p.technologies || []).slice(0, 4).map(t => `<span class="tech-tag">${t}</span>`).join('')}
                    </div>
                </div>
            </div>
        `).join('');
    }

    window.openProject = (id) => {
        const p = projectCache.find(x => x.id === id);
        if(!p) return;
        document.getElementById('modalTitle').textContent = p.title;
        document.getElementById('modalDesc').textContent = p.description;
        document.getElementById('modalTechGrid').innerHTML = (p.technologies || []).map(t => `<span class="tech-tag" style="background:rgba(0,210,255,0.2); color:white;">${t}</span>`).join('');
        document.getElementById('modalVideoContainer').innerHTML = p.video ? `<video src="${p.video}" controls autoplay style="width:100%; border-radius:10px;"></video>` : `<img src="${p.image}" style="width:100%; border-radius:10px;">`;
        
        const demoLink = document.getElementById('liveDemoLink');
        const gitLink = document.getElementById('githubLink');
        const statusMsg = document.getElementById('linkStatusMsg');
        
        demoLink.href = p.live || "#";
        gitLink.href = p.github || "#";
        
        let messages = [];
        if(!p.live || p.live === "#") messages.push('<span class="link-msg">No Live Demo link available for this project.</span>');
        if(!p.github || p.github === "#") messages.push('<span class="link-msg">No GitHub repository link available for this project.</span>');
        statusMsg.innerHTML = messages.join("");

        document.getElementById('projectModal').style.display = 'flex';
        document.body.style.overflow = 'hidden'; 
    };

    window.closeModal = () => {
        document.getElementById('projectModal').style.display = 'none';
        document.getElementById('modalVideoContainer').innerHTML = ""; 
        document.body.style.overflow = 'auto';
    };

    function handleRoute() {
        const hash = window.location.hash.replace('#', '') || 'home';
        const adminLink = document.getElementById('admin-link');
        adminLink.style.display = (hash === 'projects' || hash === 'certificates') ? 'block' : 'none';

        document.querySelectorAll('.page-view').forEach(v => v.style.display = 'none');
        const view = document.getElementById(`view-${hash}`);
        if (view) { 
            view.style.display = 'block'; 
            if (hash === 'home') { 
                if(document.getElementById("typewriter").innerHTML === "") typeWriter(); 
                initHomeDots(); 
            } 
            if (hash === 'certificates') {
                loadCertificates();
            }
        }
    }

    function typeWriter() {
        const target = document.getElementById("typewriter");
        if (target && charIdx < fullName.length) { target.innerHTML += fullName.charAt(charIdx); charIdx++; setTimeout(typeWriter, 100); }
    }

    function initHomeDots() {
        const home = document.getElementById('home-section');
        if(!home) return;
        home.querySelectorAll('.dot').forEach(d => d.remove());
        for (let i = 0; i < 45; i++) {
            const dot = document.createElement('div');
            dot.className = 'dot';
            dot.style.left = Math.random() * 100 + '%';
            dot.style.top = Math.random() * 100 + '%';
            home.appendChild(dot);
        }
    }

    window.navigateToHome = () => {
        closeMobileMenu();
        if (window.location.hash === '' || window.location.hash === '#home') {
            window.scrollTo({top: 0, behavior: 'smooth'});
        } else {
            window.location.hash = 'home';
            handleRoute();
            window.scrollTo({top: 0, behavior: 'smooth'});
        }
    };

    window.scrollToSection = (id) => {
        closeMobileMenu();
        if (window.location.hash !== '' && window.location.hash !== '#home') {
            window.location.hash = 'home';
            setTimeout(() => {
                const el = document.getElementById(id);
                if(el) el.scrollIntoView({ behavior: 'smooth' });
            }, 150);
        } else {
            const el = document.getElementById(id);
            if(el) el.scrollIntoView({ behavior: 'smooth' });
        }
    };

    window.addEventListener('hashchange', handleRoute);
    window.addEventListener('load', () => { loadData(); handleRoute(); });
</script>
</body>
</html>
